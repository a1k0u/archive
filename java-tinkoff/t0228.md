Распространение:
- v0 - консоль (.java, .class, .jar)
- v1 - Web (.jar, .war, docker)
- v2 - web + DB (docker-compose)
- v3 - оркестрация

Внедрение: общий сервер
- Установка зависимостей и приложений
- зависимость от версии JRE
- зависимости от 3-rd party
- много приложений на одном сервере
- битва за ресурсы!
  * у кого-то java 17, у кого-то java 8, кто-то использует разные версии PostgeSQL
  
Одно из решений: виртуальные машины. Зачем нужны виртуалки?
- Эмуляция hardware
- исполнение guest он host
- песочница, эмуляция архитектур, безопасность (изоляция), тестирование
  
Не страшно запускать странные приложения в песочнице :)

В итоге:
- дорого по ресурсам :(
- полная изоляция
- установка зависимостей
- установка приложения

DOCKER!!!!!
- платформа для разработки и доставки (например на винде не запустишь cassandra, а можно в контейнере запустить)
- инфраструктура как приложение
- изоляция
- легковесность
- linux namespaces (абстрация над ресурсами, изоляция и все дела) & cgroups (можно вешать лимиты на использование)


Два понятия у докера: образ и контейнер
- image - read-only шаблон (операционки, приложение зависимости)
- слои.. состоит
- union file system (своя файловая система)
- новые образы через dockerfile
- хранить образы в реестре
- спецификация дляя образов????

container - запущенная сущность образа
изолировання система

как работать с внешней средой? диск и сеть
для данных используемс bind файловой системы хоста или volume и монтируемся в память
для сети можно использовать bridge(собственная под сеть) или host; контейнеры могут общаться между собой

начнем практику
docker ps (запущенные контейнеры)
docker run -it centos (скачивается образ (с реестра) и запускает)

dockerfile
```dockerfile
FROM bellsoft/liberica-openjdk-alpine:17

RUN mkdir /app
COPY ...

CMD java -jar .. 
```

docker build -t name_here

docker run -d name_here (-d ??)

`docker ps `

но приложуха не запускается..

смотрим логи по id:

`docker logs id_container`

порт открылся, но контейнер изолирован

docker stop docker_id

запустим заново!

перебросим хостовый порт на контейнер

-p внешний порт : внутрений
-d debug
docker run -d -p 8080:8080 image_name
docker registry
- управление образами
- docker hub
- tags
- github
- локальный docker registry??

docker login -u .. -p
docker push image
чтобы выложить образ

все просто.. одно приложение.. без зависимостей
но нащим приложением заинтересовались
давайте монитизируем его, но нужно добавить какие-то вещи: БД, пользователи, подписки.. полный фарш

когда все усложняется приходит docker compose
он позволяет конфигурировать настройки запуска для этих приложений (порты, кто от кого зависит)

```Dockerfile
services:
    app:
        image:
            ...
        ports:
            8080:8080

    postgres:
        image:
            ...

        ports:
            5433:5432
        volumes:
            ...

        environment:
            ...

volumes:
    postgres-data:
        name:
```

docker-compose up

через pgadmin4 можно подклбчится к БД в контейнере
там же можно создать пользователя, таблицы...

Оркестрация?
много экземпляров приложений.. приложения падают.. меняются версии.. разный доступ к железу..
есть приложения для этого:
- кубер kubernetes (делает гениальные вещи, но все сложно..)
- openshift
- rancher

